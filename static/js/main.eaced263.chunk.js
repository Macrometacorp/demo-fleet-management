(this["webpackJsonpdemo-fleet-management"]=this["webpackJsonpdemo-fleet-management"]||[]).push([[0],{106:function(e,t,n){},166:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),s=n.n(c),o=(n(106),n(93)),i=n(205),l=n(13),u=n(9),d=n(5),b=n.n(d),j=n(11),f=n(8),h=n(187),p=n(204),x=n(189),m=n(97),O=n(191),g=n(192),v=n(1),k=Object(h.a)({header:{fontWeight:"500 !important"},aboutButton:{top:"1.1rem",right:"2rem",position:"absolute",backgroundColor:"rgb(208 225 243)",boxShadow:"none",border:"1px solid rgb(169,169,169)"},intializeButton:{top:"1.1rem",right:"8rem",position:"absolute",backgroundColor:"rgb(208 225 243)",boxShadow:"none",border:"1px solid rgb(169,169,169)"}}),w=function(e){var t=e.handleOnIntialize,n=e.isIntializeButtonDisabled,a=k();return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(x.a,{container:!0,direction:"column",justify:"center",alignItems:"stretch",children:Object(v.jsx)(m.a,{variant:"h4",align:"center",className:a.header,children:"Macrometa - Realtime Fleet Management"})}),Object(v.jsx)(O.a,{variant:"contained",className:a.intializeButton,onClick:function(){t()},children:n?Object(v.jsx)(g.a,{size:24}):"Intialize"}),Object(v.jsx)(O.a,{variant:"contained",className:a.aboutButton,onClick:function(){window.open("https://github.com/Macrometacorp/demo-fleet-management","_blank")},children:"About"})]})},y=Object(h.a)({root:{display:"flex",justifyContent:"center",marginTop:"1rem"},actionButton:{marginRight:"3rem",backgroundColor:"rgb(208 225 243)",width:"9rem",boxShadow:"none",border:"1px solid rgb(169,169,169)"}}),_=function(e){var t=e.handleOnStart,n=e.handleOnStop,a=e.isStartButtonDisabled,r=e.isStopButtonDisabled,c=e.isStreamStarted,s=y();return Object(v.jsxs)("div",{className:s.root,children:[Object(v.jsx)(O.a,{variant:"contained",className:s.actionButton,onClick:t,disabled:a||c,children:a?Object(v.jsx)(g.a,{size:24}):"Start"}),Object(v.jsx)(O.a,{variant:"contained",className:s.actionButton,onClick:n,disabled:r||!c,children:r?Object(v.jsx)(g.a,{size:24}):"Stop"})]})},C=n(94),S=n(87),N=n.n(S),M=n(208),F=n(193),B=Object(h.a)({actionButton:{backgroundColor:"#fff",width:"9rem",boxShadow:"none",border:"1px solid rgb(169,169,169)"}});function D(e){var t=e.setChartFilter,n=Object(a.useState)("week"),r=Object(f.a)(n,2),c=r[0],s=r[1],o=B();return Object(a.useEffect)((function(){t(c)}),[c]),Object(v.jsxs)(M.a,{value:c,exclusive:!0,onChange:function(e,t){return s(t)},"aria-label":"text alignment",style:{margin:"15px 0px"},children:[Object(v.jsx)(F.a,{value:"week",className:o.actionButton,children:"Week"}),Object(v.jsx)(F.a,{value:"month",className:o.actionButton,children:"Month"}),Object(v.jsx)(F.a,{value:"year",className:o.actionButton,children:"Year"}),Object(v.jsx)(F.a,{value:"all",className:o.actionButton,children:"All"})]})}var R=Object(h.a)({root:{flexDirection:"column",display:"flex"},securitiesSelect:{width:"12rem"},selectGrid:{paddingBottom:"1rem"},selectLabel:{paddingRight:"1rem",fontSize:"1.5rem"},chartCanvas:{height:"19.5rem"},heading:{margin:"10px",fontSize:"28px",fontWeight:400}}),I=function(){var e=Object(a.useRef)(null),t=R(),n=Object(a.useState)("week"),r=Object(f.a)(n,2),c=r[0],s=r[1],o=Object(a.useState)({}),i=Object(f.a)(o,2),l=i[0],u=i[1];Object(a.useEffect)((function(){var e={week:{dataset1:[5,10,20,10,20,30],dataset2:[-5,-10,-20,-10,-20,-30]},month:{dataset1:[15,15,25,15,25,35],dataset2:[-15,-15,-25,-15,-25,-35]},year:{dataset1:[50,100,200,100,200,300],dataset2:[-50,-100,-200,-100,-200,-300]},all:{dataset1:[15,15,25,15,25,35],dataset2:[-15,-15,-25,-15,-25,-35]}};u(e[c]||e.week)}),[c]),Object(a.useEffect)((function(){var e=d(l);return function(){e.destroy()}}),[e.current,l]);var d=function(t){return new C.a(e.current,{type:"line",options:{maintainAspectRatio:!1,plugins:{legend:{display:!1}},elements:{point:{radius:0}},scales:{x:{grid:{display:!1},ticks:{autoSkip:!1}},y:{grid:{display:!1},ticks:{autoSkip:!1}}}},data:{labels:[1,2,3,4,5,6,7],datasets:[{data:t.dataset1,backgroundColor:"red",borderColor:"red",borderWidth:1},{data:t.dataset2,backgroundColor:"yellow",borderColor:"yellow",borderWidth:1}]}})};return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)("div",{className:t.root,children:[Object(v.jsx)(x.a,{container:!0,alignItems:"center",children:Object(v.jsx)(x.a,{item:!0,children:Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)(N.a,{style:{fontSize:50}}),Object(v.jsx)("h3",{className:t.heading,children:" Fleet Status"})]})})}),Object(v.jsx)("div",{className:t.chartCanvas,children:Object(v.jsx)("canvas",{ref:e})}),Object(v.jsx)(D,{setChartFilter:s})]})})},A=n(194),E=n(195),L=n(196),z=n(197),T=n(198),W=n(199),P=n(88),q=n.n(P),U=n(89),Y=n.n(U),J=Object(h.a)({tableCell:{padding:"1.9px 10px",border:"1px solid"},textRed:{color:"red"},textYellow:{color:"#d0d00f"},textGreen:{color:"green"},textOrange:{color:"orange"}});function V(){var e=J(),t=[{col1:Object(v.jsxs)(v.Fragment,{children:["Attention required ",Object(v.jsx)("br",{})," (Next 7 days)"]}),col3:Object(v.jsx)("b",{className:e.textRed,children:"1048"})},{col1:Object(v.jsxs)(v.Fragment,{children:["Critical Status ",Object(v.jsx)("br",{})," (Next 7 days)"]}),col3:Object(v.jsx)("b",{className:e.textYellow,children:"374"})},{col1:Object(v.jsxs)(v.Fragment,{children:["Fleet Health ",Object(v.jsx)("br",{})," (Last 7 days)"]}),col3:Object(v.jsx)("b",{className:e.textGreen,children:"89.04%"})},{col1:Object(v.jsxs)(v.Fragment,{children:["Unplanned Maintenance ",Object(v.jsx)("br",{})," (Last 7 days)"]}),col3:Object(v.jsx)("b",{className:e.textRed,children:"171"})},{col1:Object(v.jsxs)(v.Fragment,{children:["Planned Maintenance ",Object(v.jsx)("br",{})," (Next 7 days)"]}),col3:Object(v.jsx)("b",{className:e.textRed,children:"234"})}];return Object(v.jsx)(A.a,{component:E.a,children:Object(v.jsx)(L.a,{className:e.table,"aria-label":"custom pagination table",children:Object(v.jsx)(z.a,{children:t&&t.map((function(t,n){return Object(v.jsxs)(T.a,{children:[Object(v.jsx)(W.a,{className:e.tableCell,children:t.col1}),Object(v.jsx)(W.a,{className:e.tableCell,style:{width:"50px"},children:n%2===0?Object(v.jsx)(q.a,{style:{fontSize:50}}):Object(v.jsx)(Y.a,{style:{fontSize:50}})}),Object(v.jsx)(W.a,{className:e.tableCell,children:t.col3})]},Math.random())}))})})})}var $=n(57),K=n.n($),G={gdnURL:"https://gdn-us-west.paas.macrometa.io",apiKey:"demo-fleet-management_macrometa.io.demo_hitachi_fleet_management.42cNCEdgD4iIoIGdUQw8hzFkI3aDhuB1YmtkOFUEMs1dOlVHu2jETQUv0suJ1pT99c6098"},H="maintenance_centers",Q="planned_maintenance",X="telematics",Z="get_telematics_30_days",ee="get_top5_maintenance_centers_for_city",te="get_asset_details",ne="enriched-telematics",ae=["load_maintenance_centers","load_planned_maintenance","load_telematics","load_area_issue_counts","load_issue_counts","load_vehicle_issue_counts","load_fleet_stats_counts"],re=[H,Q,X,"unplanned_maintenance","issue_counts","area_issue_counts","fleet_stats","vehicle_issue_counts"],ce=["insights-worker","fleet-stats-worker","telematics-worker","telematics-simulator"],se=new K.a({url:G.gdnURL,apiKey:"".concat(G.apiKey)}),oe=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"London",e.prev=1,e.next=4,se.executeRestql(ee,{City:t});case 4:return n=e.sent,a=n.result,e.abrupt("return",a);case 9:throw e.prev=9,e.t0=e.catch(1),console.error(e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,se.executeRestql(Z);case 3:return t=e.sent,n=t.result,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),le=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,se.executeRestql(te,{Asset:t});case 3:return n=e.sent,a=n.result,e.abrupt("return",a);case 8:throw e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,se.executeRestql("insert_unplanned_maintenance",t);case 3:return n=e.sent,a=n.result,e.abrupt("return",a);case 8:throw e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,se.executeRestql("get_telematic_insights");case 3:return t=e.sent,n=t.result,a=Object(f.a)(n,1),r=a[0],e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(0),console.error(e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),be=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r,c,s=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s.length>0&&void 0!==s[0]&&s[0],e.prev=1,n=ce,!1===t&&n.reverse(),a=Object(u.a)(n),e.prev=5,a.s();case 7:if((r=a.n()).done){e.next=13;break}return c=r.value,e.next=11,se.activateStreamApp(c,t);case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),a.e(e.t0);case 18:return e.prev=18,a.f(),e.finish(18);case 21:return e.abrupt("return",!0);case 24:return e.prev=24,e.t1=e.catch(1),console.error("Failed start ot stop strams",e.t1.message),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,null,[[1,24],[5,15,18,21]])})));return function(){return e.apply(this,arguments)}}(),je=function(){var e=Object(j.a)(b.a.mark((function e(t,n){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,se.createStreamReader(t,"".concat(t,"-").concat(Math.round(1e3*Math.random())),!1,!1,G.gdnURL.replace("https://",""),{filters:n});case 3:a=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}(),fe=function(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])},he=Object(h.a)({tableCell:{padding:"0.7rem",border:"1px solid"},heading:{margin:"10px",fontSize:"28px",fontWeight:400}}),pe={Vehicle_With_Most_Frequent_Issues:"Vechicle with most frequent issue",Most_Common_Alert:"Most Common Alert",Total_Cost_Of_Unplanned_Maintenance:"Total Cost of Unplanned Maintenance",Area_With_Most_Alerts:"Area with most Alerts",Least_Cost_Effective_Vehicle:"Least Cost Effective Vehicle"};function xe(){var e=he(),t=Object(a.useState)({}),n=Object(f.a)(t,2),r=n[0],c=n[1],s=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,de();case 3:t=e.sent,c(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("falied to load the insigths",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){s()}),[]),fe(s,3e3),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{style:{display:"flex",marginBottom:"10px"},children:[Object(v.jsx)("span",{className:"fab fa-searchengin",style:{fontSize:40,marginTop:"10px"}}),Object(v.jsx)("h3",{className:e.heading,children:" Insights"})]}),Object(v.jsx)(A.a,{component:E.a,children:Object(v.jsx)(L.a,{className:e.table,"aria-label":"custom pagination table",children:Object(v.jsx)(z.a,{children:Object.keys(pe)&&Object.keys(pe).map((function(t){return Object(v.jsxs)(T.a,{children:[Object(v.jsx)(W.a,{className:e.tableCell,children:pe[t]}),Object(v.jsx)(W.a,{className:e.tableCell,children:r&&r.hasOwnProperty(t)&&r[t]}),Object(v.jsx)(W.a,{className:e.tableCell,children:"investigate"})]},Math.random())}))})})})]})}var me=n(22),Oe=n(200),ge=n(207),ve=n(92),ke=n.n(ve),we=n(58),ye=n.n(we),_e={backgroundColor:"#4b81c3",width:"9rem",boxShadow:"none",border:"1px solid rgb(169,169,169)",color:"#ffffff",borderRadius:0,"&:hover":{backgroundColor:"#4b81c3",color:"#ffffff"}},Ce=function(e){var t=ye()(e),n=ye()();return t.from(n)},Se=function(e){if(e)return ye()(e).format("D MMM YYYY")},Ne=function(){return Math.floor(1e6+9e5*Math.random())},Me=Object(h.a)((function(e){return{actionButton:{backgroundColor:"#ffffff",width:"9rem",boxShadow:"none",border:"1px solid rgb(169,169,169)",borderRadius:0},activeActionButton:_e,root:{display:"flex","& > *":{marginRight:e.spacing(2),marginTop:"0.6rem",flex:1}}}}));function Fe(e){var t=e.stats,n=e.setAlterFilter,r=Me(),c=Object(a.useState)("all"),s=Object(f.a)(c,2),o=s[0],i=s[1],l=t.all,u=t.critical,d=t.attention,b=t.booked,j=function(e){return"".concat(o===e?r.activeActionButton:r.actionButton)};return Object(a.useEffect)((function(){n(o)}),[o]),Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)("div",{className:r.root,children:[Object(v.jsxs)(O.a,{variant:"outlined",onClick:function(){return i("all")},className:j("all"),children:["All (",l,")"]}),Object(v.jsxs)(O.a,{variant:"outlined",onClick:function(){return i("critical")},className:j("critical"),children:["Critical (",u,")"]}),Object(v.jsxs)(O.a,{variant:"outlined",onClick:function(){return i("attention")},className:j("attention"),children:["Attention (",d,")"]}),Object(v.jsxs)(O.a,{variant:"outlined",onClick:function(){return i("booked")},className:j("booked"),children:["Booked (",b,")"]})]})})}var Be=n(206),De=n(201),Re=n(202),Ie=n(203),Ae=Object(h.a)((function(e){return{activeActionButton:Object(me.a)(Object(me.a)({},_e),{},{width:"5rem"}),root:{"& > *":{margin:e.spacing(1)}}}})),Ee=function(e){var t=Object(a.useRef)(),n=Ae();return Object(a.useEffect)((function(){return window.$(t.current).datepicker({onSelect:function(t){e.onDateChange(t)},defaultDate:e.initialDate}),function(){window.$(t.current).datepicker("destroy")}}),[]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("input",{ref:t,style:{visibility:"hidden",width:0}}),Object(v.jsx)(O.a,{variant:"contained",color:"primary",style:{padding:"0px"},className:n.activeActionButton,onClick:function(){return window.$(t.current).datepicker("show")},children:"Select"})]})},Le=Object(h.a)({table:{minWidth:650},root:{},pagination:{borderRadius:"none"}});function ze(e){var t=e.handleSelect,n=e.alertData,r=Le(),c=Object(a.useState)("06/15/2021"),s=Object(f.a)(c,1)[0],o=Object(a.useState)([]),i=Object(f.a)(o,2),l=i[0],u=i[1],d=function(){var e=Object(j.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,oe(t);case 3:n=e.sent,u(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("falied to load maintenace centers",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){var e=n.City;d(e)}),[]),Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(m.a,{component:"div",className:r.root,children:Object(v.jsx)(A.a,{component:E.a,children:Object(v.jsxs)(L.a,{className:r.table,"aria-label":"simple table",children:[Object(v.jsx)(Oe.a,{children:Object(v.jsxs)(T.a,{children:[Object(v.jsx)(W.a,{children:"Maintenance Center"}),Object(v.jsx)(W.a,{align:"center",children:"Rating"}),Object(v.jsx)(W.a,{align:"center",children:"City"}),Object(v.jsx)(W.a,{align:"center",children:"Estimated Time"}),Object(v.jsx)(W.a,{align:"center",children:"Estimated Cost"}),Object(v.jsx)(W.a,{align:"center",children:"Select"})]})}),Object(v.jsx)(z.a,{children:l&&l.map((function(e,n){return Object(v.jsxs)(T.a,{style:n%2?{background:"rgb(208 225 243)"}:{},children:[Object(v.jsx)(W.a,{align:"center",children:e.Name}),Object(v.jsxs)(W.a,{align:"center",children:[e.Rating,"/5.0"]}),Object(v.jsx)(W.a,{align:"center",children:e.City}),Object(v.jsxs)(W.a,{align:"center",children:[e.Estimated_Time,"  ",1===e.Estimated_Time?"Day":"Days"]}),Object(v.jsxs)(W.a,{align:"center",children:["$",e.Estimated_Cost]}),Object(v.jsx)(W.a,{align:"center",children:Object(v.jsx)(Ee,{onDateChange:function(n){t({date:n,maintenaceData:e})},initialDate:s},Math.random())})]},Math.random())}))})]})})})})}var Te=n(91),We=n.n(Te),Pe={cursor:"pointer",float:"right",marginTop:"5px",width:"50px"};function qe(e){var t=e.openModal,n=e.closeModal,c=e.handleSelect,s=r.a.useState(!1),o=Object(f.a)(s,2),i=o[0],l=o[1],u=Object(a.useState)({status:!1,data:{}}),d=Object(f.a)(u,2),b=d[0],j=d[1];Object(a.useEffect)((function(){l(t.status),j(t.data)}),[t.status]);var h=function(){l(!1),n()},p=function(e){l(!1),n(),c(Object(me.a)(Object(me.a)({},e),{},{_key:b._key,data:b}))},x=b.Asset;return Object(v.jsx)(r.a.Fragment,{children:Object(v.jsxs)(Be.a,{fullWidth:!0,maxWidth:"md",open:i,onClose:h,"aria-labelledby":"max-width-dialog-title",children:[Object(v.jsxs)(De.a,{id:"max-width-dialog-title",children:[x,Object(v.jsx)(We.a,{fontSize:"large",onClick:h,style:Pe})]}),Object(v.jsx)(Re.a,{children:Object(v.jsx)(Ie.a,{children:Object(v.jsx)(ze,{alertData:b,handleSelect:function(e){return p(e)}})})})]})})}var Ue=Object(h.a)({table:{minWidth:650},root:{paddingTop:"1rem"},pagination:{borderRadius:"none"},activeActionButton:Object(me.a)(Object(me.a)({},_e),{},{width:"4rem"}),heading:{margin:"10px",fontSize:"28px",fontWeight:400}});function Ye(e){var t=e.alertsData,n=Ue(),c=Object(a.useState)({status:!1,data:{}}),s=Object(f.a)(c,2),o=s[0],i=s[1],u=Object(a.useState)({all:0,critical:0,attention:0,booked:0}),d=Object(f.a)(u,2),h=d[0],p=d[1],x=Object(a.useState)("all"),m=Object(f.a)(x,2),g=m[0],k=m[1],w=Object(a.useState)([]),y=Object(f.a)(w,2),_=y[0],C=y[1],S=Object(a.useState)([]),N=Object(f.a)(S,2),M=N[0],F=N[1],B=Object(a.useState)([]),D=Object(f.a)(B,2),R=D[0],I=D[1],P=r.a.useState(1),q=Object(f.a)(P,2),U=q[0],Y=q[1],J=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ie();case 3:t=e.sent,F(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("falied to load maintenace centers",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r,c,s,o,i,l,u,d,j,h,p;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.data,a=n.Asset,r=n.Fault,c=t.date,s=t.maintenaceData,e.next=5,le(a);case 5:return o=e.sent,i=Object(f.a)(o,1),l=i[0],u=l.Driver,d=l.Vehicle_Model,j=s.Estimated_Cost,h=new Date(c),p={Asset:a,Booked_In:h.toISOString(),Invoice_Number:Ne(),Cost_Center:Ne(),Vehicle_Model:d,Driver:u,Work_Description:r,Work_Cost:j},e.next=14,ue(p);case 14:console.log("successfully booking processed!"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.error("Failed to book maintenance",e.t0.message);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){J()}),[]),Object(a.useEffect)((function(){var e=function(e,t){var n,a,r=[],c=t;for(n=0,a=e.length;n<a;n+=c)r.push(e.slice(n,n+c));return r}(M.filter((function(e){var t=g.toLowerCase();return"all"===t||("booked"===t?"yes"===e.Maintenance_Planned.toLowerCase():e.Status_Level.toLowerCase()===t)})),8);C(e),I(e[U-1|0]),Y(1)}),[g,M]),Object(a.useEffect)((function(){I(_[U-1])}),[U]),Object(a.useEffect)((function(){var e=Object(f.a)(t,1)[0],n=void 0===e?{}:e;n&&Object.keys(n).length>0&&(n._key=Ne(),F([n].concat(Object(l.a)(M))))}),[t]),Object(a.useEffect)((function(){var e={all:M.length,critical:0,attention:0,booked:0};M.forEach((function(t){"yes"===t.Maintenance_Planned.toLowerCase()&&(e.booked+=1),"critical"===t.Status_Level.toLowerCase()&&(e.critical+=1),"attention"===t.Status_Level.toLowerCase()&&(e.attention+=1)})),p(e)}),[M]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{style:{display:"flex"},children:[Object(v.jsx)(ke.a,{style:{fontSize:50}}),Object(v.jsx)("h3",{className:n.heading,children:"Alerts"})]}),Object(v.jsx)(Fe,{stats:h,setAlterFilter:k}),Object(v.jsxs)("div",{className:n.root,children:[Object(v.jsxs)(A.a,{component:E.a,children:[Object(v.jsxs)(L.a,{className:n.table,"aria-label":"simple table",children:[Object(v.jsx)(Oe.a,{children:Object(v.jsxs)(T.a,{children:[Object(v.jsx)(W.a,{style:{width:"5rem"},children:"Vechicle ID"}),Object(v.jsx)(W.a,{align:"center",children:"Alert \xa0 Description"}),Object(v.jsx)(W.a,{align:"center",children:"Date \xa0 Logged"}),Object(v.jsx)(W.a,{align:"center",children:"Status level"}),Object(v.jsx)(W.a,{align:"center",children:"Maintenance \xa0 Planned"}),Object(v.jsx)(W.a,{align:"center",style:{width:"5rem"},children:"Action"})]})}),Object(v.jsx)(z.a,{children:R&&R.map((function(e,t){return Object(v.jsxs)(T.a,{style:t%2?{background:"rgb(208 225 243)"}:{},children:[Object(v.jsx)(W.a,{align:"center",children:e.Asset}),Object(v.jsx)(W.a,{align:"center",children:e.Fault}),Object(v.jsx)(W.a,{align:"center",children:Ce(e.Timestamp)}),Object(v.jsx)(W.a,{align:"center",style:{color:"".concat("Critical"===e.Status_Level?"red":"")},children:e.Status_Level}),Object(v.jsx)(W.a,{align:"center",children:e.Maintenance_Planned}),Object(v.jsx)(W.a,{align:"center",children:"yes"===e.Maintenance_Planned.toLowerCase()?Object(v.jsxs)(v.Fragment,{children:["Booked",Object(v.jsx)("br",{}),Se(e.Booked_In)]}):Object(v.jsx)(O.a,{variant:"contained",color:"primary",className:n.activeActionButton,style:{padding:"0px"},onClick:function(){return i({status:!0,data:e})},children:"Book"})})]},Math.random())}))})]}),Object(v.jsx)(ge.a,{className:n.pagination,count:_.length,showFirstButton:!0,showLastButton:!0,page:U,onChange:function(e,t){Y(t)}})]}),Object(v.jsx)(qe,{openModal:o,closeModal:function(){return i({status:!1,data:{id:0}})},handleSelect:function(e){return function(e){var t=M.map((function(t){if(t._key===e._key){t.Maintenance_Planned="Yes";var n=new Date(e.date);t.Booked_In=n.toISOString()}return t}));F(t),V(e)}(e)}})]})]})}var Je=new K.a({url:G.gdnURL,apiKey:"".concat(G.apiKey)}),Ve=function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be();case 3:return e.next=5,$e();case 5:return e.next=7,Ke();case 7:return e.next=9,Ge();case 9:t(!1),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Failed to intialize",e.t0.message),t(!1);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),$e=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=re.map((function(e){return Je.collection(e).truncate()})),e.next=4,Promise.all(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Failed to truncate",e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),Ke=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=ae.slice(0,2).map((function(e){return Je.executeRestql(e)})),e.next=4,Promise.all(t);case 4:return e.next=6,Je.executeRestql(ae[2]);case 6:return n=ae.slice(3).map((function(e){return Je.executeRestql(e)})),e.next=9,Promise.all(n);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Failed to load",e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),Ge=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Je.executeRestql("on_ready");case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Failed to onReady",e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),He=Object(h.a)({root:{padding:"0.5rem"},section:{paddingRight:"2rem"},aboutButton:{top:"1.1rem",right:"2rem",position:"absolute",backgroundColor:"rgb(208 225 243)",boxShadow:"none",border:"1px solid rgb(169,169,169)"}}),Qe=function(){var e=He(),t=Object(a.useState)(!1),n=Object(f.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)(!1),o=Object(f.a)(s,2),i=o[0],d=o[1],h=Object(a.useState)(!1),m=Object(f.a)(h,2),O=m[0],g=m[1],k=Object(a.useState)(!1),y=Object(f.a)(k,2),C=y[0],S=y[1],N=Object(a.useState)([]),M=Object(f.a)(N,2),F=M[0],B=M[1],D=Object(a.useState)([]),R=Object(f.a)(D,2),A=R[0],E=R[1],L=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("starting intialized..."),S(!0),e.next=4,Ve(S);case 4:console.log("started intialized!");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=Object(u.a)(F),e.prev=2,t.s();case 4:if((n=t.n()).done){e.next=10;break}return a=n.value,e.next=8,a.terminate();case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:return e.next=20,be();case 20:e.sent&&c(!1),g(!1),e.next=28;break;case 25:e.prev=25,e.t1=e.catch(0),console.error("Failed to close steam and webscoker",e.t1.message);case 28:case"end":return e.stop()}}),e,null,[[0,25],[2,12,15,18]])})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be(!0);case 3:if(!e.sent){e.next=10;break}return e.next=7,W(ne);case 7:t=e.sent,B((function(e){return[].concat(Object(l.a)(F),[t])})),c(!0);case 10:d(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Failed to close steam and webscoket",e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(j.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,je(t);case 3:return(n=e.sent).on("open",(function(){return console.log("Connection open for ".concat(t))})),n.on("error",(function(e){return console.error("Connection error for ".concat(t),e)})),n.on("close",(function(){return console.log("Connection close for ".concat(t))})),n.on("message",(function(e){n.send(JSON.stringify({messageId:JSON.parse(e).messageId})),P(e,ne)})),e.abrupt("return",n);case 11:e.prev=11,e.t0=e.catch(0),console.error("error",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),P=function(e,t){var n=[],a=function(e){var t=JSON.parse(e).payload,n=JSON.parse(e).messageId,a=atob(t);return 0===a.length?{newData:{},messageId:n}:{newData:JSON.parse(a),messageId:n}}(e).newData;a&&(n.push(a),E([].concat(Object(l.a)(A),n)))};return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(p.a,{className:e.root,maxWidth:!1,children:[Object(v.jsx)(w,{handleOnIntialize:L,isIntializeButtonDisabled:C}),Object(v.jsx)(_,{handleOnStart:function(){console.log("starting streams..."),d(!0),T(),console.log("started streams!")},handleOnStop:function(){console.log("stoping intialized..."),g(!0),z(),console.log("stoped intialized!")},isStartButtonDisabled:i,isStopButtonDisabled:O,isStreamStarted:r}),Object(v.jsxs)(x.a,{container:!0,direction:"row",style:{paddingTop:"32px"},alignItems:"flex-start",children:[Object(v.jsx)(x.a,{item:!0,xs:6,className:e.section,children:Object(v.jsxs)(x.a,{container:!0,direction:"row",alignItems:"flex-start",children:[Object(v.jsx)(x.a,{item:!0,xs:6,className:e.section,children:Object(v.jsx)(I,{})}),Object(v.jsx)(x.a,{item:!0,xs:6,className:e.section,style:{marginTop:"4rem"},children:Object(v.jsx)(V,{})}),Object(v.jsx)(x.a,{item:!0,xs:12,className:e.section,children:Object(v.jsx)(xe,{})})]})}),Object(v.jsx)(x.a,{item:!0,xs:6,className:e.section,children:Object(v.jsx)(Ye,{alertsData:A})})]})]})})},Xe=Object(o.a)({typography:{fontFamily:"Lato"},overrides:{MuiTableCell:{root:{padding:"0.8rem"},stickyHeader:{backgroundColor:"#d0e0f3"},head:{color:"#ffffff",fontWeight:900}},MuiTypography:{root:{fontWeight:"600 !important"}},MuiButton:{label:{textTransform:"capitalize",fontWeight:"600"}},MuiFormControl:{root:{height:"56px"}},MuiInputLabel:{outlined:{transform:"translate(14px, 0.7rem) scale(1)"}},MuiOutlinedInput:{input:{padding:"0.65rem 14px"}},MuiPaginationItem:{root:{borderRadius:"0px"},page:{padding:"25px","&$selected":{backgroundColor:"#4b81c3",color:"#ffffff","&:hover":{backgroundColor:"#4b81c3",color:"#ffffff"}},"&:hover":{backgroundColor:"#4b81c3",color:"#ffffff"}}},MuiToggleButton:{root:{"&$selected":{backgroundColor:"#4b81c3",color:"#ffffff","&:hover":{backgroundColor:"#4b81c3",color:"#ffffff"}},"&:hover":{backgroundColor:"#4b81c3",color:"#ffffff"}}},MuiTableHead:{root:{backgroundColor:"#4b81c3"}},MuiTableContainer:{root:{overflowX:"inherit"}}}}),Ze=function(){return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(i.a,{theme:Xe,children:Object(v.jsx)(Qe,{})})})},et=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,209)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(Ze,{})}),document.getElementById("root")),et()}},[[166,1,2]]]);
//# sourceMappingURL=main.eaced263.chunk.js.map