(this["webpackJsonpdemo-fleet-management"]=this["webpackJsonpdemo-fleet-management"]||[]).push([[0],{137:function(e,t,n){},242:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),s=n.n(c),o=(n(137),n(122)),i=n(288),l=n(13),u=n(16),d=n(7),b=n.n(d),j=n(12),f=n(9),p=n(270),h=n(287),x=n(272),m=n(126),O=n(274),v=n(275),g=n(1),k=Object(p.a)({header:{fontWeight:"500 !important"},aboutButton:{top:"1.1rem",right:"2rem",position:"absolute",backgroundColor:"rgb(208 225 243)",boxShadow:"none",border:"1px solid rgb(169,169,169)"},intializeButton:{top:"1.1rem",right:"8rem",position:"absolute",backgroundColor:"rgb(208 225 243)",boxShadow:"none",border:"1px solid rgb(169,169,169)"}}),w=function(e){var t=e.handleOnIntialize,n=e.isIntializeButtonDisabled,a=k();return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(x.a,{container:!0,direction:"column",justify:"center",alignItems:"stretch",children:[Object(g.jsx)(m.a,{variant:"h4",align:"center",className:a.header,children:"Macrometa - Realtime Fleet Management"}),Object(g.jsx)(m.a,{variant:"subtitle1",align:"center",className:a.header,children:"Simple, secure and scalable realtime fleet management."})]}),Object(g.jsx)(O.a,{variant:"contained",className:a.intializeButton,onClick:function(){t()},children:n?Object(g.jsx)(v.a,{size:24}):"Intialize"}),Object(g.jsx)(O.a,{variant:"contained",className:a.aboutButton,onClick:function(){window.open("https://github.com/Macrometacorp/demo-fleet-management","_blank")},children:"About"})]})},y=Object(p.a)({root:{display:"flex",justifyContent:"center",marginTop:"1rem"},actionButton:{marginRight:"3rem",backgroundColor:"rgb(208 225 243)",width:"9rem",boxShadow:"none",border:"1px solid rgb(169,169,169)"}}),_=function(e){var t=e.handleOnStart,n=e.handleOnStop,a=e.isLoading,r=e.isStartButtonDisabled,c=e.isStopButtonDisabled,s=e.isStreamStarted,o=y();return Object(g.jsxs)("div",{className:o.root,children:[Object(g.jsx)(O.a,{variant:"contained",className:o.actionButton,onClick:t,disabled:r&&!c||s,children:a?Object(g.jsx)(v.a,{size:24}):"Start"}),Object(g.jsx)(O.a,{variant:"contained",className:o.actionButton,onClick:n,disabled:!r&&c||!s,children:c?Object(g.jsx)(v.a,{size:24}):"Stop"})]})},S=n(123),C=n(113),M=n.n(C),N=n(292),F=n(276),B=Object(p.a)({actionButton:{backgroundColor:"#fff",width:"9rem",boxShadow:"none",border:"1px solid rgb(169,169,169)"}});function R(e){var t=e.setChartFilter,n=Object(a.useState)("week"),r=Object(f.a)(n,2),c=r[0],s=r[1],o=B();return Object(a.useEffect)((function(){t(c)}),[c]),Object(g.jsxs)(N.a,{value:c,exclusive:!0,onChange:function(e,t){return s(t)},"aria-label":"text alignment",style:{margin:"15px 0px"},children:[Object(g.jsx)(F.a,{value:"week",className:o.actionButton,children:"Week"}),Object(g.jsx)(F.a,{value:"month",className:o.actionButton,children:"Month"}),Object(g.jsx)(F.a,{value:"year",className:o.actionButton,children:"Year"})]})}var L=n(70),I=n.n(L),A={gdnURL:"https://tushar.eng.macrometa.io",apiKey:"hitachi_gmail.com.hitachi_demo.VpK6C4aIszkTM2lItx4g8vpwFmdR65Eiw1h8iYtyenUWdlK74TgSYr6yT0egkqpo3cfb22"},D=n(289),E=n(40),T=n.n(E),z="maintenance_centers",q="planned_maintenance",W="telematics",P="get_telematics_30_days",Y="get_top5_maintenance_centers_for_city",U="get_asset_details",V="get_fleet_stats_chart_data",J="enriched-telematics",K=["load_maintenance_centers","load_planned_maintenance","load_telematics","load_area_issue_counts","load_issue_counts","load_vehicle_issue_counts","load_fleet_stats_counts"],H=[z,q,W,"unplanned_maintenance","issue_counts","area_issue_counts","fleet_stats","vehicle_issue_counts"],$=["insights-worker","fleet-stats-worker","telematics-worker","telematics-simulator"],G=new I.a({url:A.gdnURL,apiKey:"".concat(A.apiKey)}),X=D.a("Critical_Status"),Q=D.a("Attention_Required"),Z=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"London",e.prev=1,e.next=4,G.executeRestql(Y,{City:t});case 4:return n=e.sent,a=n.result,e.abrupt("return",a);case 9:throw e.prev=9,e.t0=e.catch(1),console.error(e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.executeRestql(P);case 3:return t=e.sent,n=t.result,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.executeRestql(U,{Asset:t});case 3:return n=e.sent,a=n.result,e.abrupt("return",a);case 8:throw e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.executeRestql("insert_unplanned_maintenance",t);case 3:return n=e.sent,a=n.result,e.abrupt("return",a);case 8:throw e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.executeRestql("get_telematic_insights");case 3:return t=e.sent,n=t.result,a=Object(f.a)(n,1),r=a[0],e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(0),console.error(e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.executeRestql("get_fleet_stats");case 3:return t=e.sent,n=t.result,a=Object(f.a)(n,1),r=a[0],e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(0),console.error(e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r,c=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:"week",e.prev=1,n={week:{},year:{},month:{},all:{}},e.next=5,G.executeRestql(V);case 5:return a=e.sent,(r=a.result)&&(r=r.forEach((function(e){e&&e.last_week&&(n.week.dataset1=X(e.last_week),n.week.dataset2=Q(e.last_week),n.week.label=D.a("Date")(e.last_week)),e&&e.last_month&&(e.last_month.sort((function(e,t){return T()(e.Month,"MMM-YYYY").valueOf()-T()(t.Month,"MMM-YYYY").valueOf()})),n.month.dataset1=X(e.last_month),n.month.dataset2=Q(e.last_month),n.month.label=D.a("Month")(e.last_month)),e&&e.last_year&&(n.year.dataset1=X(e.last_year),n.year.dataset2=Q(e.last_year),n.year.label=D.a("Year")(e.last_year))}))),e.abrupt("return",n[t]);case 11:throw e.prev=11,e.t0=e.catch(1),console.error(e.t0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r,c,s=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s.length>0&&void 0!==s[0]&&s[0],e.prev=1,n=$,!1===t&&n.reverse(),a=Object(l.a)(n),e.prev=5,a.s();case 7:if((r=a.n()).done){e.next=13;break}return c=r.value,e.next=11,G.activateStreamApp(c,t);case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),a.e(e.t0);case 18:return e.prev=18,a.f(),e.finish(18);case 21:return e.abrupt("return",!0);case 24:return e.prev=24,e.t1=e.catch(1),console.error("Failed start ot stop strams",e.t1.message),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,null,[[1,24],[5,15,18,21]])})));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=Object(j.a)(b.a.mark((function e(t,n){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.createStreamReader(t,"".concat(t,"-").concat(Math.round(1e3*Math.random())),!1,!1,A.gdnURL.replace("https://",""),{filters:n});case 3:a=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}(),ie=function(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])},le=Object(p.a)({root:{flexDirection:"column",display:"flex"},securitiesSelect:{width:"12rem"},selectGrid:{paddingBottom:"1rem"},selectLabel:{paddingRight:"1rem",fontSize:"1.5rem"},chartCanvas:{height:"19.5rem"},heading:{margin:"10px",fontSize:"28px",fontWeight:400}}),ue=function(){var e=Object(a.useRef)(null),t=le(),n=Object(a.useState)("week"),r=Object(f.a)(n,2),c=r[0],s=r[1],o=Object(a.useState)({}),i=Object(f.a)(o,2),l=i[0],u=i[1],d=function(){var e=Object(j.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(t);case 2:n=e.sent,u(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){d(c)}),[c]),ie((function(){d(c)}),1e4),Object(a.useEffect)((function(){var e=p(l);return function(){e.destroy()}}),[e.current,l]);var p=function(t){return new S.a(e.current,{type:"line",options:{maintainAspectRatio:!1,plugins:{legend:{display:!1}},elements:{point:{radius:1}},scales:{x:{grid:{display:!1}},y:{grid:{display:!1}}}},data:{labels:t.label,datasets:[{label:" Critical",data:t.dataset1,borderColor:"red",borderWidth:2},{label:" Attention",data:t.dataset2,borderColor:"#d8d800",borderWidth:2}]}})};return Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("div",{className:t.root,children:[Object(g.jsx)(x.a,{container:!0,alignItems:"center",children:Object(g.jsx)(x.a,{item:!0,children:Object(g.jsxs)("div",{style:{display:"flex"},children:[Object(g.jsx)(M.a,{style:{fontSize:50}}),Object(g.jsx)("h3",{className:t.heading,children:" Fleet Status"})]})})}),Object(g.jsx)("div",{className:t.chartCanvas,children:Object(g.jsx)("canvas",{ref:e})}),Object(g.jsx)(R,{setChartFilter:s})]})})},de=n(277),be=n(278),je=n(279),fe=n(280),pe=n(281),he=n(282),xe=n(114),me=n.n(xe),Oe=n(115),ve=n.n(Oe),ge=Object(p.a)({tableCell:{padding:"1.9px 10px",border:"1px solid"}});function ke(){var e=ge(),t=Object(a.useState)({}),n=Object(f.a)(t,2),r=n[0],c=n[1],s=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re();case 3:t=e.sent,c(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("falied to load the insigths",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){s()}),[]),ie(s,3e3);var o={Attention_Required:Object(g.jsxs)(g.Fragment,{children:["Attention required ",Object(g.jsx)("br",{})," (Last 7 days)"]}),Critical_Status:Object(g.jsxs)(g.Fragment,{children:["Critical Status ",Object(g.jsx)("br",{})," (Last 7 days)"]}),Fleet_Health:Object(g.jsxs)(g.Fragment,{children:["Fleet Health ",Object(g.jsx)("br",{})," (Last 7 days)"]}),Unplanned_Maintenance:Object(g.jsxs)(g.Fragment,{children:["Unplanned Maintenance ",Object(g.jsx)("br",{})," (Last 7 days)"]}),Planned_Maintenance:Object(g.jsxs)(g.Fragment,{children:["Planned Maintenance ",Object(g.jsx)("br",{})," (Next 7 days)"]})};return Object(g.jsx)(de.a,{component:be.a,children:Object(g.jsx)(je.a,{className:e.table,"aria-label":"custom pagination table",children:Object(g.jsx)(fe.a,{children:Object.keys(o)&&Object.keys(o).map((function(t,n){return Object(g.jsxs)(pe.a,{children:[Object(g.jsx)(he.a,{className:e.tableCell,children:o[t]}),Object(g.jsx)(he.a,{className:e.tableCell,style:{width:"50px"},children:r&&r[t]&&"Up"===r[t].arrow?Object(g.jsx)(me.a,{style:{fontSize:50}}):Object(g.jsx)(ve.a,{style:{fontSize:50}})}),Object(g.jsx)(he.a,{className:e.tableCell,children:"Fleet_Health"===t?"-":Object(g.jsx)("b",{style:{color:"".concat(r&&r[t]&&"Up"===r[t].arrow?"green":"red")},children:r&&r[t]&&r[t][t]})})]},Math.random())}))})})})}var we=Object(p.a)({tableCell:{padding:"0.7rem",border:"1px solid"},heading:{margin:"10px",fontSize:"28px",fontWeight:400}}),ye={Vehicle_With_Most_Frequent_Issues:"Vechicle with most frequent issue",Most_Common_Alert:"Most Common Alert",Total_Cost_Of_Unplanned_Maintenance:"Total Cost of Unplanned Maintenance",Area_With_Most_Alerts:"Area with most Alerts",Least_Cost_Effective_Vehicle:"Least Cost Effective Vehicle"};function _e(){var e=we(),t=Object(a.useState)({}),n=Object(f.a)(t,2),r=n[0],c=n[1],s=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae();case 3:t=e.sent,c(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("falied to load the insigths",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){s()}),[]),ie(s,3e3),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{style:{display:"flex",marginBottom:"10px"},children:[Object(g.jsx)("span",{className:"fab fa-searchengin",style:{fontSize:40,marginTop:"10px"}}),Object(g.jsx)("h3",{className:e.heading,children:" Insights"})]}),Object(g.jsx)(de.a,{component:be.a,children:Object(g.jsx)(je.a,{className:e.table,"aria-label":"custom pagination table",children:Object(g.jsx)(fe.a,{children:Object.keys(ye)&&Object.keys(ye).map((function(t){return Object(g.jsxs)(pe.a,{children:[Object(g.jsx)(he.a,{className:e.tableCell,children:ye[t]}),Object(g.jsx)(he.a,{className:e.tableCell,children:r&&r.hasOwnProperty(t)?r[t]:"-"}),Object(g.jsx)(he.a,{className:e.tableCell,children:"investigate"})]},Math.random())}))})})})]})}var Se=n(25),Ce=n(283),Me=n(291),Ne=n(116),Fe=n.n(Ne),Be={backgroundColor:"#4b81c3",width:"9rem",boxShadow:"none",border:"1px solid rgb(169,169,169)",color:"#ffffff",borderRadius:0,"&:hover":{backgroundColor:"#4b81c3",color:"#ffffff"}},Re=function(e){var t=T()(e),n=T()();return t.from(n)},Le=function(e){if(e)return T()(e).format("D MMM YYYY")},Ie=function(){return Math.floor(1e6+9e5*Math.random())},Ae=Object(p.a)((function(e){return{actionButton:{backgroundColor:"#ffffff",width:"9rem",boxShadow:"none",border:"1px solid rgb(169,169,169)",borderRadius:0},activeActionButton:Be,root:{display:"flex","& > *":{marginRight:"10px",marginTop:"0.6rem",flex:1,padding:"5px 0px"}}}}));function De(e){var t=e.stats,n=e.setAlterFilter,r=Ae(),c=Object(a.useState)("all"),s=Object(f.a)(c,2),o=s[0],i=s[1],l=t.all,u=t.critical,d=t.attention,b=t.booked,j=t.unbooked,p=function(e){return"".concat(o===e?r.activeActionButton:r.actionButton)};return Object(a.useEffect)((function(){n(o)}),[o]),Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("div",{className:r.root,children:[Object(g.jsxs)(O.a,{variant:"outlined",onClick:function(){return i("all")},className:p("all"),children:["All (",l,")"]}),Object(g.jsxs)(O.a,{variant:"outlined",onClick:function(){return i("critical")},className:p("critical"),children:["Critical (",u,")"]}),Object(g.jsxs)(O.a,{variant:"outlined",onClick:function(){return i("attention")},className:p("attention"),children:["Attention (",d,")"]}),Object(g.jsxs)(O.a,{variant:"outlined",onClick:function(){return i("booked")},className:p("booked"),children:["Booked (",b,")"]}),Object(g.jsxs)(O.a,{variant:"outlined",onClick:function(){return i("unbooked")},className:p("unbooked"),children:["To be Booked (",j,")"]})]})})}var Ee=Object(p.a)({table:{minWidth:650},root:{paddingTop:"1rem"},pagination:{borderRadius:"none"},activeActionButton:Object(Se.a)(Object(Se.a)({},Be),{},{width:"4rem"}),heading:{margin:"10px",fontSize:"28px",fontWeight:400}});function Te(e){var t=e.alertsData,n=e.setOpenModal,c=Ee(),s=Object(a.useState)({all:0,critical:0,attention:0,booked:0}),o=Object(f.a)(s,2),i=o[0],l=o[1],u=Object(a.useState)("all"),d=Object(f.a)(u,2),b=d[0],j=d[1],p=Object(a.useState)([]),h=Object(f.a)(p,2),x=h[0],m=h[1],v=Object(a.useState)([]),k=Object(f.a)(v,2),w=k[0],y=k[1],_=Object(a.useState)([]),S=Object(f.a)(_,2),C=S[0],M=S[1],N=r.a.useState(1),F=Object(f.a)(N,2),B=F[0],R=F[1];return Object(a.useEffect)((function(){var e=function(e,t){var n,a,r=[],c=t;for(n=0,a=e.length;n<a;n+=c)r.push(e.slice(n,n+c));return r}(w.filter((function(e){var t=b.toLowerCase();return"all"===t||("booked"===t?"yes"===e.Maintenance_Planned.toLowerCase():"unbooked"===t?"no"===e.Maintenance_Planned.toLowerCase():e.Status_Level.toLowerCase()===t)})),8);m(e),M(e[B-1|0]),e.length<B?R(1):R(B)}),[b,w]),Object(a.useEffect)((function(){M(x[B-1])}),[B]),Object(a.useEffect)((function(){y(t)}),[t]),Object(a.useEffect)((function(){var e={all:w.length,critical:0,attention:0,booked:0,unbooked:0};w.forEach((function(t){"yes"===t.Maintenance_Planned.toLowerCase()&&(e.booked+=1),"no"===t.Maintenance_Planned.toLowerCase()&&(e.unbooked+=1),"critical"===t.Status_Level.toLowerCase()&&(e.critical+=1),"attention"===t.Status_Level.toLowerCase()&&(e.attention+=1)})),l(e)}),[w]),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{style:{display:"flex"},children:[Object(g.jsx)(Fe.a,{style:{fontSize:50}}),Object(g.jsx)("h3",{className:c.heading,children:"Alerts"})]}),Object(g.jsx)(De,{stats:i,setAlterFilter:j}),Object(g.jsx)("div",{className:c.root,children:Object(g.jsxs)(de.a,{component:be.a,children:[Object(g.jsxs)(je.a,{className:c.table,"aria-label":"simple table",children:[Object(g.jsx)(Ce.a,{children:Object(g.jsxs)(pe.a,{children:[Object(g.jsx)(he.a,{style:{width:"5rem"},children:"Vechicle ID"}),Object(g.jsx)(he.a,{align:"center",children:"Alert \xa0 Description"}),Object(g.jsx)(he.a,{align:"center",children:"Date \xa0 Logged"}),Object(g.jsx)(he.a,{align:"center",children:"Status level"}),Object(g.jsx)(he.a,{align:"center",children:"Maintenance \xa0 Planned"}),Object(g.jsx)(he.a,{align:"center",style:{width:"5rem"},children:"Action"})]})}),Object(g.jsx)(fe.a,{children:C&&C.map((function(e,t){return Object(g.jsxs)(pe.a,{style:t%2?{background:"rgb(208 225 243)"}:{},children:[Object(g.jsx)(he.a,{align:"center",children:e.Asset}),Object(g.jsx)(he.a,{align:"center",children:e.Fault}),Object(g.jsx)(he.a,{align:"center",children:Re(e.Timestamp)}),Object(g.jsx)(he.a,{align:"center",style:{color:"".concat("Critical"===e.Status_Level?"red":"")},children:e.Status_Level}),Object(g.jsx)(he.a,{align:"center",children:e.Maintenance_Planned}),Object(g.jsx)(he.a,{align:"center",children:"yes"===e.Maintenance_Planned.toLowerCase()?Object(g.jsxs)(g.Fragment,{children:["Booked",Object(g.jsx)("br",{}),Le(e.Booked_In)]}):Object(g.jsx)(O.a,{variant:"contained",color:"primary",className:c.activeActionButton,style:{padding:"0px"},onClick:function(){return n({status:!0,data:e})},children:"Book"})})]},Math.random())}))})]}),Object(g.jsx)(Me.a,{className:c.pagination,count:x.length,showFirstButton:!0,showLastButton:!0,page:B,onChange:function(e,t){R(t)}})]})})]})}var ze=new I.a({url:A.gdnURL,apiKey:"".concat(A.apiKey)}),qe=function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ye(!1);case 3:return e.next=5,se();case 5:return e.next=7,We();case 7:return e.next=9,Pe();case 9:return e.next=11,Ye(!0);case 11:t(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Failed to intialize",e.t0.message),t(!1);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),We=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=H.map((function(e){return ze.collection(e).truncate()})),e.next=4,Promise.all(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Failed to truncate",e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),Pe=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=K.slice(0,2).map((function(e){return ze.executeRestql(e)})),e.next=4,Promise.all(t);case 4:return e.next=6,ze.executeRestql(K[2]);case 6:return n=K.slice(3).map((function(e){return ze.executeRestql(e)})),e.next=9,Promise.all(n);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Failed to load",e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),Ye=function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ze.executeRestql("on_ready",{status:t});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Failed to onReady",e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ze.executeRestql("is_demo_ready");case 3:return t=e.sent,n=t.result,a=Object(f.a)(n,1),r=a[0],e.abrupt("return",r&&r.ready||!1);case 9:return e.prev=9,e.t0=e.catch(0),console.error("Failed to onReady",e.t0.message),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Ve=n(290),Je=n(284),Ke=n(285),He=n(286),$e=n(118),Ge=n.n($e),Xe=(n(197),Object(p.a)({table:{minWidth:650},activeActionButton:Object(Se.a)(Object(Se.a)({},Be),{},{width:"5rem"}),pagination:{borderRadius:"none"}}));function Qe(e){var t=e.handleSelect,n=e.alertData,r=Xe(),c=Object(a.useState)({}),s=Object(f.a)(c,2),o=s[0],i=s[1],l=Object(a.useState)([]),u=Object(f.a)(l,2),d=u[0],p=u[1],h=Object(a.useState)(!1),x=Object(f.a)(h,2),v=x[0],k=x[1],w=function(){var e=Object(j.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z(t);case 3:n=e.sent,p(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("falied to load maintenace centers",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),y=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=n.City;w(e),document.querySelector(".react-datepicker-wrapper").style.visibility="hidden",document.querySelector(".react-datepicker-wrapper").style.width="64px"}),[]),Object(g.jsx)(g.Fragment,{children:Object(g.jsx)(m.a,{component:"div",className:r.root,children:Object(g.jsx)(de.a,{component:be.a,children:Object(g.jsxs)(je.a,{className:r.table,"aria-label":"simple table",children:[Object(g.jsx)(Ce.a,{children:Object(g.jsxs)(pe.a,{children:[Object(g.jsx)(he.a,{children:"Maintenance Center"}),Object(g.jsx)(he.a,{align:"center",children:"Rating"}),Object(g.jsx)(he.a,{align:"center",children:"City"}),Object(g.jsx)(he.a,{align:"center",children:"Estimated Time"}),Object(g.jsx)(he.a,{align:"center",children:"Estimated Cost"}),Object(g.jsxs)(he.a,{align:"center",children:["Select",Object(g.jsx)(Ge.a,{minDate:new Date,ref:function(e){y.current=e},onChange:function(e){t({date:e,maintenaceData:o})}})]})]})}),Object(g.jsx)(fe.a,{children:d&&d.map((function(e,t){return Object(g.jsxs)(pe.a,{style:t%2?{background:"rgb(208 225 243)"}:{},children:[Object(g.jsx)(he.a,{align:"center",children:e.Name}),Object(g.jsxs)(he.a,{align:"center",children:[e.Rating,"/5.0"]}),Object(g.jsx)(he.a,{align:"center",children:e.City}),Object(g.jsxs)(he.a,{align:"center",children:[e.Estimated_Time,"  ",1===e.Estimated_Time?"Day":"Days"]}),Object(g.jsxs)(he.a,{align:"center",children:["$",e.Estimated_Cost]}),Object(g.jsx)(he.a,{align:"center",children:Object(g.jsx)(O.a,{variant:"contained",color:"primary",style:{padding:"0px"},className:r.activeActionButton,onClick:function(){return function(e){i(e),y.current.setOpen(!0),k(!v)}(e)},children:"Select"})})]},Math.random())}))})]})})})})}var Ze=n(121),et=n.n(Ze),tt={cursor:"pointer",float:"right",marginTop:"5px",width:"50px"},nt=r.a.memo((function(e){var t=e.openModal,n=e.closeModal,c=e.handleSelect,s=r.a.useState(!1),o=Object(f.a)(s,2),i=o[0],l=o[1],u=Object(a.useState)({status:!1,data:{}}),d=Object(f.a)(u,2),b=d[0],j=d[1];Object(a.useEffect)((function(){l(t.status),j(t.data)}),[t.status]);var p=function(){l(!1),n()},h=function(e){l(!1),n(),c(Object(Se.a)(Object(Se.a)({},e),{},{_key:b._key,data:b}))},x=b.Asset;return Object(g.jsx)(r.a.Fragment,{children:Object(g.jsxs)(Ve.a,{fullWidth:!0,maxWidth:"md",open:i,onClose:p,"aria-labelledby":"max-width-dialog-title",children:[Object(g.jsxs)(Je.a,{id:"max-width-dialog-title",children:[x,Object(g.jsx)(et.a,{fontSize:"large",onClick:p,style:tt})]}),Object(g.jsx)(Ke.a,{children:Object(g.jsx)(He.a,{children:Object(g.jsx)(Qe,{alertData:b,handleSelect:function(e){return h(e)}})})})]})})})),at=Object(p.a)({root:{padding:"0.5rem"},section:{paddingRight:"2rem"},aboutButton:{top:"1.1rem",right:"2rem",position:"absolute",backgroundColor:"rgb(208 225 243)",boxShadow:"none",border:"1px solid rgb(169,169,169)"}}),rt=function(){var e=at(),t=Object(a.useState)(!1),n=Object(f.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)(!1),o=Object(f.a)(s,2),i=o[0],d=o[1],p=Object(a.useState)(!1),m=Object(f.a)(p,2),O=m[0],v=m[1],k=Object(a.useState)(!1),y=Object(f.a)(k,2),S=y[0],C=y[1],M=Object(a.useState)(!0),N=Object(f.a)(M,2),F=N[0],B=N[1],R=Object(a.useState)([]),L=Object(f.a)(R,2),I=L[0],A=L[1],D=Object(a.useState)([]),E=Object(f.a)(D,2),T=E[0],z=E[1],q=Object(a.useState)({status:!1,data:{}}),W=Object(f.a)(q,2),P=W[0],Y=W[1],U=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue();case 2:(t=e.sent)||z([]),B(!t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a,r,c,s,o,i,l,u,d,j,p,h;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.data,a=n.Asset,r=n.Fault,c=t.date,s=t.maintenaceData,e.next=5,te(a);case 5:return o=e.sent,i=Object(f.a)(o,1),l=i[0],u=l.Driver,d=l.Vehicle_Model,j=s.Estimated_Cost,p=new Date(c),h={Asset:a,Booked_In:p.toISOString(),Invoice_Number:Ie(),Cost_Center:Ie(),Vehicle_Model:d,Driver:u,Work_Description:r,Work_Cost:j},e.next=14,ne(h);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.error("Failed to book maintenance",e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){U()}),[i,O,S]);var K=function(){var e=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),e.next=3,qe(C);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ee();case 3:t=e.sent,n=(n=Object(u.a)(t)).filter((function(e){return e})).filter((function(e){return Object.keys(e).length>0})),n=Object(u.a)(new Map(n.map((function(e){return[e._key,e]}))).values()),z(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("falied to load maintenace centers",e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){S||H()}),[S]);var $=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=Object(l.a)(I),e.prev=2,t.s();case 4:if((n=t.n()).done){e.next=10;break}return a=n.value,e.next=8,a.terminate();case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:return e.next=20,se();case 20:e.sent&&c(!1),v(!1),e.next=28;break;case 25:e.prev=25,e.t1=e.catch(0),console.error("Failed to close steam and webscoker",e.t1.message);case 28:case"end":return e.stop()}}),e,null,[[0,25],[2,12,15,18]])})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,se(!0);case 3:if(!e.sent){e.next=10;break}return e.next=7,X(J);case 7:t=e.sent,A((function(e){return[].concat(Object(u.a)(I),[t])})),c(!0);case 10:d(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Failed to close steam and webscoket",e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(j.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,oe(t);case 3:return(n=e.sent).on("open",(function(){return console.info("Connection open for ".concat(t))})),n.on("error",(function(e){return console.error("Connection error for ".concat(t),e)})),n.on("close",(function(){return console.info("Connection close for ".concat(t))})),n.on("message",(function(e){n.send(JSON.stringify({messageId:JSON.parse(e).messageId})),Q(e,J)})),e.abrupt("return",n);case 11:e.prev=11,e.t0=e.catch(0),console.error("error",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),Q=function(e,t){var n=[],a=function(e){var t=JSON.parse(e).payload,n=JSON.parse(e).messageId,a=atob(t);return 0===a.length?{newData:{},messageId:n}:{newData:JSON.parse(a),messageId:n}}(e).newData,r=void 0===a?{}:a;r&&0!==Object.keys(r).length&&(r._key=Ie(),n.push(r),z((function(e){return[].concat(n,Object(u.a)(e))})))};return Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)(h.a,{className:e.root,maxWidth:!1,children:[Object(g.jsx)(w,{handleOnIntialize:K,isIntializeButtonDisabled:S}),Object(g.jsx)(_,{handleOnStart:function(){d(!0),G()},handleOnStop:function(){v(!0),$()},isLoading:i,isStartButtonDisabled:F,isStopButtonDisabled:O,isStreamStarted:r}),Object(g.jsxs)(x.a,{container:!0,direction:"row",style:{paddingTop:"32px"},alignItems:"flex-start",children:[Object(g.jsx)(x.a,{item:!0,xs:6,className:e.section,children:Object(g.jsxs)(x.a,{container:!0,direction:"row",alignItems:"flex-start",children:[Object(g.jsx)(x.a,{item:!0,xs:6,className:e.section,children:Object(g.jsx)(ue,{})}),Object(g.jsx)(x.a,{item:!0,xs:6,className:e.section,style:{marginTop:"4rem"},children:Object(g.jsx)(ke,{})}),Object(g.jsx)(x.a,{item:!0,xs:12,className:e.section,children:Object(g.jsx)(_e,{})})]})}),Object(g.jsx)(x.a,{item:!0,xs:6,className:e.section,children:Object(g.jsx)(Te,{alertsData:T,setOpenModal:Y})})]}),Object(g.jsx)(nt,{openModal:P,closeModal:function(){return Y({status:!1,data:{id:0}})},handleSelect:function(e){return function(e){var t=T.map((function(t){if(t._key===e._key){t.Maintenance_Planned="Yes";var n=new Date(e.date);t.Booked_In=n.toISOString()}return t}));z(t),V(e)}(e)}})]})})},ct=Object(o.a)({typography:{fontFamily:"Lato"},overrides:{MuiTableCell:{root:{padding:"0.8rem"},stickyHeader:{backgroundColor:"#d0e0f3"},head:{color:"#ffffff",fontWeight:900}},MuiTypography:{root:{fontWeight:"600 !important"}},MuiButton:{label:{textTransform:"capitalize",fontWeight:"600"}},MuiFormControl:{root:{height:"56px"}},MuiInputLabel:{outlined:{transform:"translate(14px, 0.7rem) scale(1)"}},MuiOutlinedInput:{input:{padding:"0.65rem 14px"}},MuiPaginationItem:{root:{borderRadius:"0px"},page:{padding:"23px","&$selected":{backgroundColor:"#4b81c3",color:"#ffffff","&:hover":{backgroundColor:"#4b81c3",color:"#ffffff"}},"&:hover":{backgroundColor:"#4b81c3",color:"#ffffff"}}},MuiToggleButton:{root:{"&$selected":{backgroundColor:"#4b81c3",color:"#ffffff","&:hover":{backgroundColor:"#4b81c3",color:"#ffffff"}},"&:hover":{backgroundColor:"#4b81c3",color:"#ffffff"}}},MuiTableHead:{root:{backgroundColor:"#4b81c3"}},MuiTableContainer:{root:{overflowX:"inherit"}}}}),st=function(){return Object(g.jsx)(g.Fragment,{children:Object(g.jsx)(i.a,{theme:ct,children:Object(g.jsx)(rt,{})})})},ot=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,293)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(g.jsx)(r.a.StrictMode,{children:Object(g.jsx)(st,{})}),document.getElementById("root")),ot()}},[[242,1,2]]]);
//# sourceMappingURL=main.4f496b9f.chunk.js.map